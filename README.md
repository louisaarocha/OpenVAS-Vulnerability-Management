Vulnerability Management using OpenVAS
---------

## Project Summary 
This project serves as a hands-on exploration of essential practices within the realm of cybersecurity vulnerability management. It places a strong emphasis on vulnerability scanning and the meticulous process of remediation. Leveraging the capabilities of OpenVAS, I orchestrated scans on local VMs hosted within the Azure environment. The project's scope spanned both non-credentialed and credentialed scans, providing comprehensive insights into system vulnerabilities. Subsequently, meticulous remediation procedures were applied to rectify identified issues. The final step involved meticulous validation, ensuring the efficacy of the remediation efforts through a rigorous rescan.

## Key Highlights:
- **Azure Environment Setup:** Established a secure Azure environment, laying the groundwork for comprehensive vulnerability management activities.
- **OpenVAS Deployment:** Successfully installed and configured OpenVAS from the Azure marketplace, creating a robust Vulnerability Management Scanner.
- **Security Best Practices:** Prioritized security by promptly changing default credentials upon web app login.
- **Realistic Vulnerable VM:** Created an intentionally vulnerable client VM, simulating real-world scenarios for effective assessment.
- **Comprehensive Scanning:** Executed both unauthenticated and credentialed scans to provide a thorough analysis of vulnerabilities.
- **Effective Remediation:** Developed and applied remediation strategies, enhancing the security of the client VM.
- **Validation of Remediation:** Ensured the success of remediation efforts through post-remediation scans, validating their impact on security.
- **Proactive Cybersecurity Learning:** The project delivers practical insights into the Vulnerability Management Lifecycle, equipping proactive cybersecurity skills.
  
## Skills Demonstrated:
- Vulnerability Management
- Azure Environment Setup
- OpenVAS Proficiency
- Security Best Practices
- Comprehensive Scanning 
- Remediation Strategies
- Validation and Verification
  
## Project Steps

1. **Vulnerability Management Scanner Configuration**
   - Installing OpenVAS from the Azure marketplace, I set up our Vulnerability Management Scanner.
   - SSH into the vulnerability management server with PowerShell using the credentials created earlier.
  
<br>
<p align="center">  
   <img src="https://imgur.com/7LtpaF2.png" height="60%" width="60%" alt="Alt text" title="Vulnerability management server">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/2kWVNMv.png" height="60%" width="60%" alt="Alt text" title="SSH into vulnerability management server">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/1Ybnrb3.png" height="60%" width="60%" alt="Alt text" title="Greenbone">
</p>
<br>

  
2. **Create Client Virtual Machine and make it vulnerable**
    - This VM is inside the same virtual network as our vulnerability scanner.

<br>
<p align="center">  
   <img src="https://imgur.com/E7iiaSm.png" height="60%" width="60%" alt="Alt text" title="Create Client VM">
</p>
<br>
  
3. **Remotely login to Client VM**
    - RDP into VM with credentials created. 
    - Disable firewalls.

<br>
<p align="center">  
   <img src="https://imgur.com/7ZodxvY.png" height="60%" width="60%" alt="Alt text" title="RDP">
</p>
<br>


<br>
<p align="center">  
   <img src="https://imgur.com/Gb243X7.png" height="60%" width="60%" alt="Alt text" title="Welcome screen">
</p>
<br>


<br>
<p align="center">  
   <img src="https://imgur.com/wjwbFVe.png" height="60%" width="60%" alt="Alt text" title="Disable firewalls">
</p>
<br>
  
4. **Install deprecated software on Client VM** 
    - Install an Old Version of Firefox: Firefox Setup 97.0b5
    - Install an Old Version of VLC Player: vlc-1.1.7-win32
    - Install an Old Version of Adobe Reader: 10.0_AdbeRdr1000_en_US_1_

<br>
<p align="center">  
   <img src="https://imgur.com/fEN561n.png" height="60%" width="60%" alt="Alt text" title="Deprecated software installed">
</p>
<br>


5. **Configure OpenVAS to perform the first unauthenticated scan against the vulnerable VM**
     - Create new Host: Add the Client VM private IP address.
     - Create new Target from the host: "Azure Vulnerable VMs"
     - Create new Task: "Azure Vulnerable VMs"

<br>
<p align="center">  
   <img src="https://imgur.com/QDNpQ4z.png" height="60%" width="60%" alt="Alt text" title="Create new Host">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/6QXYk2Y.png" height="60%" width="60%" alt="Alt text" title="Create new Target">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/Fys41FB.png" height="60%" width="60%" alt="Alt text" title="Create new Task">
</p>
<br>

6. **Perform scan and review results**
     
<br>
<p align="center">  
   <img src="https://imgur.com/lQWR4Fg.png" height="60%" width="60%" alt="Alt text" title="Perform scan">
</p>
<br>


<br>
<p align="center">  
   <img src="https://imgur.com/WGnRfXT.png" height="60%" width="60%" alt="Alt text" title="Review results">
</p>
<br>


8. **Make Configurations for Credentialed Scans (within VM)**
    - Disable Windows Firewall (already done).
    - Disable User Account Control.
    - Enable Remote Registry.
    - Set Registry Key.
      - Launch Registry Editor (regedit.exe)
      - Navigate to HKEY_LOCAL_MACHINE hive
      - Open SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key
      - Create a new DWORD (32-bit) value with the following properties:
        - Name: LocalAccountTokenFilterPolicy
        - Value: 1
      - Close Registry Editor
     - Restart the VM
       
<br>
<p align="center">  
   <img src="https://imgur.com/7B8Mx6m.png" height="60%" width="60%" alt="Alt text" title="Disable User Account Control">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/2OIKVF6.png" height="60%" width="60%" alt="Alt text" title="Enable Remote Registry.">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/LhqbEQP.png" height="60%" width="60%" alt="Alt text" title=" Set Registry Key.">
</p>
<br>
       
8. **Make Configurations for Credentialed Scans (OpenVAS)**
    - Configuration → Credentials → New Credential
      - Name / Comment: “Azure VM Credentials”
      - Allow Insecure Use: Yes
      - Username: azureuser
      - Password: ****
      - Save
   - Go to Configuration → Targets → CLONE the Target made before
     - NEW Name / Comment: “Azure Vulnerable VMs - Credentialed Scan”
     - Ensure the Private IP is still accurate
     - Credentials → SMB → Select the Credentials just made: Azure VM Credentials
     - Save

<br>
<p align="center">  
   <img src="https://imgur.com/4GnWJCG.png" height="60%" width="60%" alt="Alt text" title="New Credential">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/JXM9NBk.png" height="60%" width="60%" alt="Alt text" title="CLONE Target">
</p>
<br>

 9. **Execute Credentialed Scan against our Vulnerable Windows VM**
    - Within Greenbone / OpenVAS, go to Scans → Tasks
    - CLONE the “Scan - Azure Vulnerable VMs” Task, then Edit it:
      - Name / Comment: “Scan - Azure Vulnerable VMs - Credentialed”
      - Targets: Azure Vulnerable VMs - Credentialed Scan
      - Save
    - Click the Play button to launch the new Credentialed Scan.
      
<br>
<p align="center">  
   <img src="https://imgur.com/JaKutcE.png" height="60%" width="60%" alt="Alt text" title="Edit Target clone">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/JraoUO0.png" height="60%" width="60%" alt="Alt text" title="New Target">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/pjgtwW6.png" height="60%" width="60%" alt="Alt text" title="Launch credentialed scan">
</p>
<br>

10. **Credentialed Scan finished**
    - After the credentialed scan finishes, you can immediately see the difference in findings: severity is high. 
    - Inspect the individual vulnerabilities and see all the Criticals from the out-of-date software.
<br>
<p align="center">  
   <img src="https://imgur.com/TOlT2Jc.png" height="60%" width="60%" alt="Alt text" title="Scans">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/qDIbjkj.png" height="60%" width="60%" alt="Alt text" title="Credentialed scan results">
</p>
<br>

11. **Remediate Vulnerabilities** 
    - Identifying vulnerabilities, I remediated them by uninstalling outdated software and restarting the VM.
    - Log back into your Win10-Vulnerable VM
    - Uninstall Adobe Reader, VLC Player, and Firefox
    - Restart the VM

<br>
<p align="center">  
   <img src="https://imgur.com/kfM2eJx.png" height="60%" width="60%" alt="Alt text" title="Uninstalling outdated software">
</p>
<br>

12. **Remediation Verification**
    - To ensure the effectiveness of the remediation efforts, I re-initiate the credentialed scan and observe the results.
    - Note: The trend line is going down because there are fewer vulnerabilities. However, there are still some high vulnerabilities. But none that are related to the older versions of Firefox, VLC, or Adobe Reader. 
<br>
<p align="center">  
   <img src="https://imgur.com/s4NFXLJ.png" height="60%" width="60%" alt="Alt text" title="Trend is down">
</p>
<br>

<br>
<p align="center">  
   <img src="https://imgur.com/pI3FASV.png" height="60%" width="60%" alt="Alt text" title="Results">
</p>
<br>










